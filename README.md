## 项目简介

Pharos 致力于构建多元化的 RWA 资产生态。然而，当我们尝试用现有的 Vault 框架去承接这些收益时，会有一个根本上的矛盾：DeFi 的结算是实时的，而 RWA 的结算是异步的；现有的标准限制了用户要么只能投 DeFi Vault，要么只能投资 RWA Vault，无法在一个 Vault 里同时获取两种收益，失去了可组合性，这一问题会随着链上资产的丰富而更加突出。除此之外，当 Vault 的底层资产从纯链上 DeFi 延伸到链下 RWA 时，可观测性成为另一个核心问题。传统 Vault 给用户展示的往往是一个静态的"预期 APY"，但用户无法观测这个数字在真实市场波动下的行为——净值会回撤多少？费用是怎么扣的？RWA 收益稳定吗？一个不可观测的 Vault，用户就无法信任，难以达到 "一键捕获多元收益" 的理想。

为此，我们提出了 Fuse Vault，一个 Real-Time Hybrid Stablecoin Vault。它创新性的在协议层融合了 ERC4626与 ERC7540 两套标准，让 DeFi 和 RWA 的收益在同一个 Vault 中共存，并产出统一的 ERC20 份额代币——这意味着用户不再需要分别管理两个仓位，而这个份额代币本身也可以被其他 DeFi 协议直接使用，甚至作为另一个 Vault 的底层资产，实现 Vault 的嵌套组合。在 RWA 侧，我们没有回避异步结算的复杂性，而是结合预言机实现了完整的链下 Operator 流程——从 pending deposit、链下资产购买确认、到份额 claim 和 NAV 报告。在可观测性方面，除了支持实时数据展示，我们用真实的 BTC 与黄金历史价格数据构建了一套可交互的 Market Replay 系统，用户可以用虚拟资金以 1x 到 100x 倍速穿越真实历史行情，主动观测 Vault 净值如何随市场波动、管理费与绩效费如何从收益中实时扣除、最大回撤在历史数据中达到过多少。

Fuse Vault 做到了同时具备真实性、可组合性、实时可观测性。

项目架构图：

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                                 用户 / 其他 DeFi 协议                                 │
└───────────────────────────────────┬─────────────────────────────────┬───────────────┘
                                    │  ERC20 份额代币                   │ 可观测性
                                    ▼                                  ▼
┌───────────────────────────────────────────────────────┐  ┌──────────────────────────┐
│                  Pharos Hybrid Vault                  │  │   Real-Time Observatory  │
│           (ERC4626 同步接口 + ERC7540 异步扩展)          │  │                          │
│                                                       │  │  ◦ Market Replay (1-100x)│
│  ┌─────────────────────────────────────────────────┐  │  │  ◦ 净值曲线 / PnL / 回撤  │
│  │              统一的份额代币 pvUSDC)                │  │  │  ◦ 资产组成实时展示       │
│  │         DeFi 收益 + RWA 收益 → 同一种代币          │  │  │  ◦ 费用计提可视化         │
│  └─────────────────────────────────────────────────┘  │  │                          │
│                                                       │  └─────────────┬────────────┘
│  ┌─────────────────────┐    ┌─────────────────────┐   │                │ 读取
│  │   DeFi 策略          │    │   RWA 策略           |  │◄───────────────┘
│  │   ERC4626 标准       │    │   ERC7540 标准       │   │
│  └──────────┬──────────┘    └──────────┬──────────┘   │
└─────────────┼───────────────────────────┼─────────────┘
              │                           │
              ▼                           ▼
┌─────────────────────────┐    ┌─────────────────────────────────┐
│   任意 ERC4626 协议      │    │   任意 RWA 资产                  │
│  (借贷、LP、其他Vault)   │    │  (美债、贸易融资、房地产代币...)  │
└─────────────────────────┘    └─────────────────────────────────┘
```

## 核心功能

### Hybrid Vault（协议创新、可组合性、真实性）

- **ERC4626 + ERC7540 融合**：同一个 Vault 同时支持同步（DeFi）和异步（RWA）两种策略
- **统一份额代币**：无论收益来自 DeFi 还是 RWA，用户拿到的都是同一种 ERC20 代币（pvUSDC）
- **自动资金分配**：用户存入 USDC，Vault 按配置比例自动分配到各策略
- **完整异步流程**：RWA 策略实现 pending → Operator 确认 → claim 的真实工作流
- **Operator 面板**：支持链下资产购买确认、NAV 报告、赎回确认
- **可组合**：份额代币可用于质押/借贷/LP，Vault 本身也可被其他 Vault 嵌套

### Real-Time Observatory（可观测性、真实性）

- **Market Replay**：基于真实 BTC/Gold 历史价格的市场回放系统
- **时间加速**：支持 1x ~ 100x 倍速，快速验证长周期表现
- **虚拟交易**：$100,000 虚拟资金，可交互买入/赎回
- **实时指标**：净值曲线、PnL 百分比、最大回撤、资产组成
- **费用可视化**：管理费（2%）、绩效费（10%）实时计提展示

### 赛题要求

| 必须实现 | 我们的方案 | 状态 |
|---------|-----------|:----:|
| **Vault 标准** | 创新的 Hybrid Vault 协议：ERC4626  + ERC7540 ，产出 ERC20 份额代币，可被任意 DeFi 协议组合 | ✅ |
| **真实策略合约** | DeFi 策略+ RWA 策略（异步流程），完整 Operator 确认工作流 | ✅ |
| **动态费率管理** | 2% 管理费 + 10% 绩效费，自动扣除，支持 feeRecipient 提取 | ✅ |
| **透明度看板** | 实时 TVL、净值曲线、PnL、最大回撤、费用计提全程可视化 | ✅ |
| **跨协议组合性** | 统一 ERC20 份额代币可直接用于质押/借贷/LP；Vault 本身可被其他 Vault 嵌套组合；现有 ERC4626 协议可低成本接入 | ✅ |

---

## 商业价值

### 市场机会

RWA 赛道正处于爆发前夜。代币化美债规模已突破 $2B，贝莱德、富兰克林邓普顿等传统资管巨头相继入场。但当前 RWA 产品与 DeFi 生态割裂——用户要么选择链上流动性，要么选择链下收益，无法兼得。Fuse Vault 正是为这个缺口而生：让用户在一个入口同时捕获 DeFi 和 RWA 的收益，同时保持资产的链上可组合性。

### 盈利模式

- **管理费**：2% 年化，按秒从 Vault 净值中计提
- **绩效费**：10%，仅对超额收益部分收取
- **规模效应**：费率固定，TVL 增长直接转化为收入增长
- **可持续性**：费用自动扣除，无需人工干预，运营成本低

### 生态定位

Fuse Vault 不是一个封闭的产品，而是 Pharos 链上的收益基础设施层：
- **向下**：任何链下 RWA 都可以作为策略接入，任何已经代币化的 RWA 也可以作为策略接入；现有 ERC4626 协议只需略作修改即可兼容
- **向上**：份额代币可被借贷、DEX、衍生品等协议直接使用
- **横向**：Fuse Vault 协议本身的接口，就允许其他 Vault 嵌套，构建更复杂的结构化产品

这意味着 Pharos Vault 的价值会随着 Pharos 生态的繁荣而放大——更多 RWA 资产上链，更多 DeFi 协议集成，Vault 的 TVL 和费用收入自然增长。

## 项目实现

### 技术栈

| 层级     | 技术                                       |      |
|------|------|---------|
| 智能合约 | Solidity 0.8.20, Hardhat, OpenZeppelin 5.0 |      |
| 协议标准 | ERC4626 + ERC7540 + ERC20                  |      |
| 前端     | Next.js 16, TypeScript, Tailwind CSS       |      |
| Web3     | wagmi + viem                               |      |
| 网络     | Pharos Testnet (Chain ID: 688689)          |      |

### 工作流

#### Deposit

```
                                    用户存入 USDC
                                         │
                                         ▼
                            ┌────────────────────────┐
                            │    Pharos Hybrid Vault  │
                            │    按比例自动分配        │
                            └────────────┬───────────┘
                                         │
                    ┌────────────────────┴────────────────────┐
                    │                                         │
                    ▼                                         ▼
        ┌───────────────────────┐              ┌───────────────────────┐
        │   同步路径 (40%)       │              │   异步路径 (60%)       │
        │   ERC4626 DeFi 策略    │              │   ERC7540 RWA 策略    │
        └───────────┬───────────┘              └───────────┬───────────┘
                    │                                      │
                    ▼                                      ▼
        ┌───────────────────────┐              ┌───────────────────────┐
        │   立即铸造份额         │              │   进入 Pending 状态    │
        │   pvUSDC 即时到账      │              │   等待 Operator 确认   │
        └───────────┬───────────┘              └───────────┬───────────┘
                    │                                      │
                    │                                      ▼
                    │                          ┌───────────────────────┐
                    │                          │   Operator 链下操作    │
                    │                          │   (购买美债等)         │
                    │                          └───────────┬───────────┘
                    │                                      │
                    │                                      ▼
                    │                          ┌───────────────────────┐
                    │                          │   fulfillDeposit()    │
                    │                          │   确认资产到账         │
                    │                          └───────────┬───────────┘
                    │                                      │
                    │                                      ▼
                    │                          ┌───────────────────────┐
                    │                          │   用户 claimShares()  │
                    │                          │   领取 pvUSDC 份额     │
                    │                          └───────────┬───────────┘
                    │                                      │
                    └──────────────────┬───────────────────┘
                                       │
                                       ▼
                            ┌───────────────────────┐
                            │   统一的 pvUSDC 代币   │
                            │   可用于其他 DeFi 协议  │
                            └───────────────────────┘
```

#### Redeem

```
                                用户发起赎回 pvUSDC
                                         │
                                         ▼
                            ┌────────────────────────┐
                            │    Pharos Hybrid Vault  │
                            │    按比例拆分赎回        │
                            └────────────┬───────────┘
                                         │
                    ┌────────────────────┴────────────────────┐
                    │                                         │
                    ▼                                         ▼
        ┌───────────────────────┐              ┌───────────────────────┐
        │   同步路径             │              │   异步路径             │
        │   DeFi 策略赎回        │              │   RWA 策略赎回         │
        └───────────┬───────────┘              └───────────┬───────────┘
                    │                                      │
                    ▼                                      ▼
        ┌───────────────────────┐              ┌───────────────────────┐
        │   立即返还 USDC        │              │   进入 Pending 状态    │
        │   资产即时到账         │              │   等待 Operator 确认   │
        └───────────┬───────────┘              └───────────┬───────────┘
                    │                                      │
                    │                                      ▼
                    │                          ┌───────────────────────┐
                    │                          │   Operator 链下操作    │
                    │                          │   (卖出美债等)         │
                    │                          └───────────┬───────────┘
                    │                                      │
                    │                                      ▼
                    │                          ┌───────────────────────┐
                    │                          │   fulfillRedeem()     │
                    │                          │   确认资产变现         │
                    │                          └───────────┬───────────┘
                    │                                      │
                    │                                      ▼
                    │                          ┌───────────────────────┐
                    │                          │   用户 claimAssets()  │
                    │                          │   领取 USDC           │
                    │                          └───────────┬───────────┘
                    │                                      │
                    └──────────────────┬───────────────────┘
                                       │
                                       ▼
                            ┌───────────────────────┐
                            │   用户收到全部 USDC    │
                            └───────────────────────┘
```

#### Observability

```
┌─────────────────────────────────────────────────────────────────────────┐
│                          Real-Time Observatory                           │
└─────────────────────────────────────────────────────────────────────────┘
                                     │
         ┌───────────────────────────┼───────────────────────────┐
         │                           │                           │
         ▼                           ▼                           ▼
┌─────────────────┐       ┌─────────────────┐       ┌─────────────────┐
│  Market Replay  │       │   实时看板       │       │   费用追踪       │
│                 │       │                 │       │                 │
│ • 历史价格回放   │       │ • TVL 总锁仓     │       │ • 管理费计提     │
│ • 1x-100x 倍速  │       │ • 净值曲线       │       │ • 绩效费计提     │
│ • 虚拟交易模拟   │       │ • PnL 百分比     │       │ • 累计费用       │
│ • 回撤可视化    │       │ • 资产组成       │       │                 │
└─────────────────┘       └─────────────────┘       └─────────────────┘
         │                           │                           │
         └───────────────────────────┼───────────────────────────┘
                                     │
                                     ▼
                          ┌─────────────────────┐
                          │  用户决策支持        │
                          │  投入前验证收益表现   │
                          └─────────────────────┘
```

### 项目结构

```
pharos-vault-initial/
├── pharos-vault/                 # 智能合约
│   ├── contracts/
│   │   ├── HybridVault.sol       # 核心 Hybrid Vault (ERC4626 + ERC7540)
│   │   ├── PharosVault.sol       # 基础 ERC4626 Vault
│   │   ├── interfaces/
│   │   │   ├── IHybridVault.sol
│   │   │   ├── IStrategy.sol
│   │   │   └── IAsyncStrategy.sol
│   │   └── strategies/
│   │       ├── BaseStrategy.sol
│   │       ├── BaseAsyncStrategy.sol
│   │       ├── SimpleLendingStrategy.sol   # DeFi 同步策略
│   │       └── AsyncRWAStrategy.sol        # RWA 异步策略
│   ├── test/
│   └── scripts/
│       └── deploy-pharos-testnet.ts
├── frontend/                     # 前端应用
│   └── src/
│       ├── app/
│       │   └── vault/live/       # Vault 交互页面
│       ├── components/
│       │   └── vault/
│       │       └── VaultSimulationBoard.tsx  # Market Replay 组件
│       ├── hooks/
│       │   ├── useVault.ts
│       │   └── useVaultSimulation.ts
│       └── lib/
│           └── simulation.ts     # 模拟逻辑
├── ARCHITECTURE.md               # 架构图
└── WORKFLOW.md                   # 工作流图
```

### 快速部署

```bash
# 1. 安装依赖
cd pharos-vault && npm install
cd ../frontend && npm install

# 2. 配置环境变量
cd ../pharos-vault
cp .env.example .env
# 编辑 .env，填入部署私钥

# 3. 部署合约到 Pharos 测试网
npm run deploy:pharos-testnet

# 4. 启动前端
cd ../frontend
npm run dev
```

### Pharos 测试网配置

| 配置项 | 值 |
|--------|-----|
| RPC URL | `https://atlantic.dplabs-internal.com` |
| Chain ID | `688689` |
| 区块浏览器 | `https://atlantic.pharosscan.xyz` |

---

## 团队信息

<!-- 请补充团队成员信息 -->

| 成员 | 邮箱 |
|------|------|
| Cauchy | cauchy160@gmail.com |
| 卢博文 | bwlu25@stu.pku.edu.cn |
| 唐彬杰 | tf171398413@gmail.com |
| Peggy | peggybabel0@gmail.com |

---

<div align="center">
**Built for 2026 GWDC Hackathon 🏆**
</div>
