# Pharos Vault 工作流

## 存款流程 (Deposit Flow)

```
                                    用户存入 USDC
                                         │
                                         ▼
                            ┌────────────────────────┐
                            │    Pharos Hybrid Vault  │
                            │    按比例自动分配        │
                            └────────────┬───────────┘
                                         │
                    ┌────────────────────┴────────────────────┐
                    │                                         │
                    ▼                                         ▼
        ┌───────────────────────┐              ┌───────────────────────┐
        │   同步路径 (40%)       │              │   异步路径 (60%)       │
        │   ERC4626 DeFi 策略    │              │   ERC7540 RWA 策略    │
        └───────────┬───────────┘              └───────────┬───────────┘
                    │                                      │
                    ▼                                      ▼
        ┌───────────────────────┐              ┌───────────────────────┐
        │   立即铸造份额         │              │   进入 Pending 状态    │
        │   pvUSDC 即时到账      │              │   等待 Operator 确认   │
        └───────────┬───────────┘              └───────────┬───────────┘
                    │                                      │
                    │                                      ▼
                    │                          ┌───────────────────────┐
                    │                          │   Operator 链下操作    │
                    │                          │   (购买美债等)         │
                    │                          └───────────┬───────────┘
                    │                                      │
                    │                                      ▼
                    │                          ┌───────────────────────┐
                    │                          │   fulfillDeposit()    │
                    │                          │   确认资产到账         │
                    │                          └───────────┬───────────┘
                    │                                      │
                    │                                      ▼
                    │                          ┌───────────────────────┐
                    │                          │   用户 claimShares()  │
                    │                          │   领取 pvUSDC 份额     │
                    │                          └───────────┬───────────┘
                    │                                      │
                    └──────────────────┬───────────────────┘
                                       │
                                       ▼
                            ┌───────────────────────┐
                            │   统一的 pvUSDC 代币   │
                            │   可用于其他 DeFi 协议  │
                            └───────────────────────┘
```

## 赎回流程 (Redeem Flow)

```
                                用户发起赎回 pvUSDC
                                         │
                                         ▼
                            ┌────────────────────────┐
                            │    Pharos Hybrid Vault  │
                            │    按比例拆分赎回        │
                            └────────────┬───────────┘
                                         │
                    ┌────────────────────┴────────────────────┐
                    │                                         │
                    ▼                                         ▼
        ┌───────────────────────┐              ┌───────────────────────┐
        │   同步路径             │              │   异步路径             │
        │   DeFi 策略赎回        │              │   RWA 策略赎回         │
        └───────────┬───────────┘              └───────────┬───────────┘
                    │                                      │
                    ▼                                      ▼
        ┌───────────────────────┐              ┌───────────────────────┐
        │   立即返还 USDC        │              │   进入 Pending 状态    │
        │   资产即时到账         │              │   等待 Operator 确认   │
        └───────────┬───────────┘              └───────────┬───────────┘
                    │                                      │
                    │                                      ▼
                    │                          ┌───────────────────────┐
                    │                          │   Operator 链下操作    │
                    │                          │   (卖出美债等)         │
                    │                          └───────────┬───────────┘
                    │                                      │
                    │                                      ▼
                    │                          ┌───────────────────────┐
                    │                          │   fulfillRedeem()     │
                    │                          │   确认资产变现         │
                    │                          └───────────┬───────────┘
                    │                                      │
                    │                                      ▼
                    │                          ┌───────────────────────┐
                    │                          │   用户 claimAssets()  │
                    │                          │   领取 USDC           │
                    │                          └───────────┬───────────┘
                    │                                      │
                    └──────────────────┬───────────────────┘
                                       │
                                       ▼
                            ┌───────────────────────┐
                            │   用户收到全部 USDC    │
                            └───────────────────────┘
```

## 可观测性流程 (Observability Flow)

```
┌─────────────────────────────────────────────────────────────────────────┐
│                          Real-Time Observatory                           │
└─────────────────────────────────────────────────────────────────────────┘
                                     │
         ┌───────────────────────────┼───────────────────────────┐
         │                           │                           │
         ▼                           ▼                           ▼
┌─────────────────┐       ┌─────────────────┐       ┌─────────────────┐
│  Market Replay  │       │   实时看板       │       │   费用追踪       │
│                 │       │                 │       │                 │
│ • 历史价格回放   │       │ • TVL 总锁仓     │       │ • 管理费计提     │
│ • 1x-100x 倍速  │       │ • 净值曲线       │       │ • 绩效费计提     │
│ • 虚拟交易模拟   │       │ • PnL 百分比     │       │ • 累计费用       │
│ • 回撤可视化    │       │ • 资产组成       │       │                 │
└─────────────────┘       └─────────────────┘       └─────────────────┘
         │                           │                           │
         └───────────────────────────┼───────────────────────────┘
                                     │
                                     ▼
                          ┌─────────────────────┐
                          │  用户决策支持        │
                          │  投入前验证收益表现   │
                          └─────────────────────┘
```
